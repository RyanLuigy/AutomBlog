name: Auto Blog Post

on:
  schedule:
    - cron: "0 * * * *"  # Executa a cada hora
  workflow_dispatch:       # Permite execu√ß√£o manual

jobs:
  auto-post:
    runs-on: ubuntu-latest

    steps:
      # 1Ô∏è‚É£ Fazer checkout do c√≥digo
      - name: üîÑ Checkout do c√≥digo
        uses: actions/checkout@v4

      # 2Ô∏è‚É£ Configurar Python
      - name: üêç Configurar Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"

      # 3Ô∏è‚É£ Instalar depend√™ncias
      - name: üì¶ Instalar depend√™ncias
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
          pip install loguru gspread google-auth google-api-python-client webdriver-manager selenium python-dateutil

      # 4Ô∏è‚É£ Criar arquivo de credenciais tempor√°rio
      - name: ‚öôÔ∏è Criar arquivo de credenciais
        run: |
          echo '${{ secrets.GOOGLE_CREDENTIALS }}' > service_account.json

      # 5Ô∏è‚É£ Executar script de postagem autom√°tica
      - name: üåç Executar auto_post.py
        env:
          SHEET_NAME: ${{ secrets.SHEET_NAME }}
          BLOG_USER: ${{ secrets.BLOG_USER }}
          BLOG_PASS: ${{ secrets.BLOG_PASS }}
          GOOGLE_CREDENTIALS: ${{ secrets.GOOGLE_CREDENTIALS }}
        run: |
          python auto_post.py

      # 6Ô∏è‚É£ Upload dos logs como artifact
      - name: üì§ Upload dos logs como artefato
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: auto_post_logs
          path: logs_auto_post.log
